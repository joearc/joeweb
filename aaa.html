<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>台灣街景大挑戰</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 極簡大地色變數覆蓋 */
        :root {
            --earth-100: #f9f5f0; /* 淺米色 */
            --earth-200: #e8ded1; /* 淺卡其 */
            --earth-300: #d4bfa8; /* 淺棕 */
            --earth-600: #8b6e4e; /* 深棕 */
            --earth-800: #5c4833; /* 暗棕 */
            --shadow: 0 2px 8px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }
        /* 全域導覽列 */
        .global-nav {
            background-color: var(--earth-100);
            border-bottom: 1px solid var(--earth-200);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow);
        }
        .global-nav ul {
            display: flex;
            gap: 2rem;
            list-style: none;
            max-width: 1200px;
            margin: 0 auto;
        }
        .global-nav a {
            color: var(--earth-600);
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 0;
            border-bottom: 2px solid transparent;
            transition: var(--transition);
        }
        .global-nav a:hover {
            color: var(--earth-800);
            border-bottom: 2px solid var(--earth-300);
        }
        .global-nav a.active {
            color: var(--earth-800);
            border-bottom: 2px solid var(--earth-600);
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            background: var(--earth-100); 
            color: var(--earth-800); 
            min-height: 100vh; 
            display: flex; 
            flex-direction: column;
            align-items: center; 
            justify-content: flex-start; 
            margin: 0; 
            overflow-x: hidden; 
            padding-top: 0;
        }
        .glass-panel { 
            background: rgba(255, 255, 255, 0.9); 
            backdrop-filter: blur(10px); 
            border: 1px solid var(--earth-200);
            box-shadow: var(--shadow);
        }
        .streetview-container { 
            aspect-ratio: 16 / 9; 
            background: var(--earth-200); 
            border-radius: 0.5rem; 
            overflow: hidden; 
            position: relative; 
            border: 1px solid var(--earth-300);
        }
        .streetview-img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            transition: opacity 0.5s ease; 
        }
        .timer-bar { 
            transition: width 1s linear; 
        }
        @keyframes shake { 
            0%, 100% { transform: translateX(0); } 
            25% { transform: translateX(-10px); } 
            75% { transform: translateX(10px); } 
        }
        .wrong-shake { 
            animation: shake 0.4s ease-in-out; 
        }
        /* 按鈕與元件樣式調整為大地色 */
        .btn-primary {
            background: var(--earth-600) !important;
            color: var(--earth-100) !important;
            border: none !important;
        }
        .btn-primary:hover {
            background: var(--earth-800) !important;
        }
        .text-primary {
            color: var(--earth-600) !important;
        }
        .bg-primary {
            background-color: var(--earth-600) !important;
        }
        .border-primary {
            border-color: var(--earth-300) !important;
        }
        .bg-secondary {
            background-color: var(--earth-200) !important;
        }
        .text-secondary {
            color: var(--earth-800) !important;
        }
    </style>
</head>
<body class="p-4">
    <!-- 全域導覽列 -->
    <nav class="global-nav w-full mb-6">
        <ul>
            <li><a href="./index.html">首頁</a></li>
            <li><a href="./about.html">關於</a></li>
            <li><a href="./game1.html" class="active">小遊戲猜地名</a></li>
            <li><a href="./game_color.html">明暗色彩分析</a></li>
        </ul>
    </nav>

    <div id="start-screen" class="text-center glass-panel p-10 rounded-3xl max-w-lg w-full">
        <h1 class="text-4xl font-black mb-2 text-primary italic">台灣街景大挑戰</h1>
        <p class="mb-10 text-secondary">挑戰你的地理直覺！每題 10 分，滿分 100。</p>
        <button onclick="startGame()" class="w-full btn-primary px-8 py-4 rounded-xl font-black text-xl hover:scale-[1.02] active:scale-95 transition-all shadow-lg">開始遊戲</button>
    </div>

    <div id="game-screen" class="hidden w-full max-w-4xl">
        <div class="mb-4 flex justify-between items-end">
            <div>
                <span class="text-secondary text-xs font-bold uppercase">Progress</span>
                <div class="text-2xl font-black text-secondary"><span id="current-q">1</span> / 10</div>
            </div>
            <div class="text-right">
                <span class="text-secondary text-xs font-bold uppercase">Score</span>
                <div id="score-display" class="text-3xl font-black text-primary">0</div>
            </div>
        </div>
        
        <div id="timer-container" class="w-full bg-secondary h-2 rounded-full mb-6 overflow-hidden">
            <div id="timer-bar" class="timer-bar h-full bg-primary" style="width: 100%"></div>
        </div>

        <div id="view-container" class="streetview-container mb-6 border border-primary">
            <img id="street-img" src="" class="streetview-img opacity-0">
            <div id="loader" class="absolute inset-0 flex flex-col items-center justify-center bg-earth-100">
                <div class="w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin mb-4"></div>
            </div>
            <div id="fallback-clue" class="absolute inset-0 hidden flex flex-col items-center justify-center bg-earth-200/90 p-8 text-center backdrop-blur-sm">
                <p class="text-primary text-xl font-bold mb-2">觀察景點特徵</p>
                <p id="clue-text" class="text-secondary text-lg italic"></p>
            </div>
        </div>

        <div id="options-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
    </div>

    <div id="result-screen" class="hidden w-full max-w-lg glass-panel p-10 rounded-3xl text-center border-2 border-primary/30">
        <h2 class="text-2xl font-bold text-secondary mb-2 uppercase tracking-tighter">Test Completed</h2>
        <p class="text-secondary">Your Final Score</p>
        <div id="final-score" class="text-8xl font-black text-primary mb-10">0</div>
        <button onclick="location.reload()" class="w-full btn-primary px-8 py-4 rounded-xl font-black text-lg hover:bg-earth-800 transition-all shadow-xl">重新挑戰</button>
    </div>

    <script>
       const QUESTIONS_CONFIG = [
  { q: "1 這是哪？", options: ["台北市", "新北市", "桃園市", "台中市"], ansIndex: 1, img: "./img/001Yonhe.jpg" },
  { q: "2 這是哪？", options: ["阿里山", "太魯閣", "陽明山", "墾丁"], ansIndex: 1, img: "./img/002Hualian.jpg" },
  { q: "3 這位於哪個縣市？", options: ["彰化", "台中", "苗栗", "台東"], ansIndex: 3, img: "./img/003Taidon.jpg" },
  { q: "4 哪個城市？", options: ["台南", "高雄", "屏東", "嘉義"], ansIndex: 0, img: "./img/004Tainan.jpg" },
  { q: "5 哪？", options: ["八里", "墾丁", "淡水", "南庄"], ansIndex: 2, img: "./img/005_danshu.jpg" },
  { q: "6 哪裡？", options: ["台南市", "高雄", "宜蘭", "台北"], ansIndex: 1, img: "./img/006Kao.jpg" },
  { q: "7 where？", options: ["台中", "新北", "高雄", "南投"], ansIndex: 0, img: "./img/007Taizon.jpg" },
  { q: "8 位於？", options: ["桃園", "淡水", "新竹", "苗栗"], ansIndex: 2, img: "./img/008shinzu_s.jpg" },
  { q: "9 哪？", options: ["桃園", "雲林", "新北", "嘉義"], ansIndex: 0, img: "./img/009Dahi.jpg" },
  { q: "10 哪裡？", options: ["金門", "南投", "花蓮", "綠島"], ansIndex: 2, img: "./img/010Liutan_s.jpg" }
];


        let currentIdx = 0;
        let score = 0;
        let timer;
        let timeLeft = 10;
        let canAnswer = true;

        function startGame() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            loadQuestion();
        }

        async function loadQuestion() {
            if (currentIdx >= QUESTIONS_CONFIG.length) {
                showResults();
                return;
            }

            canAnswer = true;
            timeLeft = 10;
            document.getElementById('current-q').innerText = currentIdx + 1;
            
            const streetImg = document.getElementById('street-img');
            const loader = document.getElementById('loader');
            const fallbackClue = document.getElementById('fallback-clue');
            const timerBar = document.getElementById('timer-bar');

            streetImg.onload = null;
            streetImg.onerror = null;
            streetImg.src = ""; 
            streetImg.classList.add('opacity-0');
            
            loader.classList.remove('hidden');
            fallbackClue.classList.add('hidden');
            timerBar.style.width = "100%";
            
            const qData = QUESTIONS_CONFIG[currentIdx];
            
            streetImg.onload = () => {
                loader.classList.add('hidden');
                streetImg.classList.remove('opacity-0');
            };
            streetImg.onerror = () => {
                loader.classList.add('hidden');
                fallbackClue.classList.remove('hidden');
                document.getElementById('clue-text').innerText = qData.q;
            };

            streetImg.src = qData.img;

            const grid = document.getElementById('options-grid');
            grid.innerHTML = '';
            const originalAns = qData.options[qData.ansIndex];
            
            [...qData.options].sort(() => Math.random() - 0.5).forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "bg-earth-100 p-4 rounded-xl border border-primary hover:border-earth-600 hover:bg-earth-200 transition-all text-left font-bold text-secondary";
                btn.innerText = opt;
                btn.onclick = () => handleAnswer(opt, originalAns, btn);
                grid.appendChild(btn);
            });

            startTimer();
        }

        function startTimer() {
            clearInterval(timer);
            timer = setInterval(() => {
                timeLeft--;
                document.getElementById('timer-bar').style.width = (timeLeft * 10) + "%";
                if (timeLeft <= 0) handleAnswer(null, QUESTIONS_CONFIG[currentIdx].options[QUESTIONS_CONFIG[currentIdx].ansIndex]);
            }, 1000);
        }

        function handleAnswer(selected, correctAnswer, btn) {
            if (!canAnswer) return;
            canAnswer = false;
            clearInterval(timer);

            const isCorrect = selected === correctAnswer;

            if (isCorrect) {
                score += 10;
                document.getElementById('score-display').innerText = score;
                if (btn) btn.classList.add('bg-green-600', 'border-green-400', '!text-white');
            } else {
                document.getElementById('view-container').classList.add('wrong-shake');
                if (btn) btn.classList.add('bg-red-600', 'border-red-400', '!text-white');
                Array.from(document.getElementById('options-grid').children).forEach(b => {
                    if (b.innerText === correctAnswer) b.classList.add('border-green-500', 'text-green-500', 'border-2');
                });
            }

            setTimeout(() => {
                document.getElementById('view-container').classList.remove('wrong-shake');
                currentIdx++;
                loadQuestion();
            }, 1500);
        }

        function showResults() {
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            document.getElementById('final-score').innerText = score;
        }
    </script>
</body>
</html>